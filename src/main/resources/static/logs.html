<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Logs</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">
</head>
<style>
    body {
        background-color: lightgray;
        font-family: Arial, "Arial Black", serif;
    }
</style>
<body>
<h2>Logs</h2>
<div id="errorMessage" style="color: red; font-weight: bold; text-align: center;"></div>
<table class="table align-middle mb-0 bg-white">
    <thead class="bg-light">
    <tr>
        <th>IssueLog Id</th>
        <th>Person Id</th>
        <th>Issue Id</th>
        <th>Old status</th>
        <th>New status</th>
        <th>Log date</th>
    </tr>
    </thead>
    <tbody id="issueLogsTableBody"></tbody>
</table>

<script>
    fetch('/bugtracker/issue-logs/all')
        .then(response => {
            if (response.status === 403) {
                throw new Error('Brak dostępu');
            } else if (!response.ok) {
                throw new Error('Wystąpił błąd: ' + response.status);
            }
            return response.json();
        })
        .then(data => {
            const issueLogsTableBody = document.getElementById('issueLogsTableBody');

            data.forEach(issueLog => {
                const row = document.createElement('tr');

                const issueLogsId = document.createElement('td');
                issueLogsId.textContent = issueLog.issueLogId;
                row.appendChild(issueLogsId);

                const personIdCell = document.createElement('td');
                personIdCell.textContent = issueLog.personId;
                row.appendChild(personIdCell);

                const issueIdCell = document.createElement('td');
                issueIdCell.textContent = issueLog.issueId;
                row.appendChild(issueIdCell);

                const oldStatusCell = document.createElement('td');
                oldStatusCell.textContent = issueLog.oldStatus;
                row.appendChild(oldStatusCell);

                const newStatusCell = document.createElement('td');
                newStatusCell.textContent = issueLog.newStatus;
                row.appendChild(newStatusCell);

                const logDateCell = document.createElement('td');
                logDateCell.textContent = issueLog.logDate;
                row.appendChild(logDateCell);

                issueLogsTableBody.appendChild(row);
            });
        })
        .catch(error => {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = error.message;
            console.error('Wystąpił błąd podczas pobierania danych:', error);
        });
</script>
<a href="/index.html">Welcome Page</a>
</body>
</html>
